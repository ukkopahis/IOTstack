
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Docker stack for getting started on IOT on the Raspberry PI">
      
      
      
      <link rel="icon" href="../../stack-24.svg">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.2.13">
    
    
      
        <title>Zigbee2MQTT - IOTstack - UKKOPAHIS-fork</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.e411adfe.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cc9b2e1e.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../style.css">
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#zigbee2mqtt" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="IOTstack - UKKOPAHIS-fork" class="md-header__button md-logo" aria-label="IOTstack - UKKOPAHIS-fork" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M11.063 1.456a1.75 1.75 0 0 1 1.874 0l8.383 5.316a1.75 1.75 0 0 1 0 2.956l-8.383 5.316a1.75 1.75 0 0 1-1.874 0L2.68 9.728a1.75 1.75 0 0 1 0-2.956l8.383-5.316zm1.071 1.267a.25.25 0 0 0-.268 0L3.483 8.039a.25.25 0 0 0 0 .422l8.383 5.316a.25.25 0 0 0 .268 0l8.383-5.316a.25.25 0 0 0 0-.422l-8.383-5.316z"/><path fill-rule="evenodd" d="M1.867 12.324a.75.75 0 0 1 1.035-.232l8.964 5.685a.25.25 0 0 0 .268 0l8.964-5.685a.75.75 0 0 1 .804 1.267l-8.965 5.685a1.75 1.75 0 0 1-1.874 0l-8.965-5.685a.75.75 0 0 1-.231-1.035z"/><path fill-rule="evenodd" d="M1.867 16.324a.75.75 0 0 1 1.035-.232l8.964 5.685a.25.25 0 0 0 .268 0l8.964-5.685a.75.75 0 0 1 .804 1.267l-8.965 5.685a1.75 1.75 0 0 1-1.874 0l-8.965-5.685a.75.75 0 0 1-.231-1.035z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            IOTstack - UKKOPAHIS-fork
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Zigbee2MQTT
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/ukkopahis/IOTstack" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ukkopahis/IOTstack
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../Basic_setup/" class="md-tabs__link">
        Basic setup
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../AdGuardHome/" class="md-tabs__link md-tabs__link--active">
        Containers
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../Developers/" class="md-tabs__link">
        Developers
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../Updates/" class="md-tabs__link">
        Updates
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="IOTstack - UKKOPAHIS-fork" class="md-nav__button md-logo" aria-label="IOTstack - UKKOPAHIS-fork" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M11.063 1.456a1.75 1.75 0 0 1 1.874 0l8.383 5.316a1.75 1.75 0 0 1 0 2.956l-8.383 5.316a1.75 1.75 0 0 1-1.874 0L2.68 9.728a1.75 1.75 0 0 1 0-2.956l8.383-5.316zm1.071 1.267a.25.25 0 0 0-.268 0L3.483 8.039a.25.25 0 0 0 0 .422l8.383 5.316a.25.25 0 0 0 .268 0l8.383-5.316a.25.25 0 0 0 0-.422l-8.383-5.316z"/><path fill-rule="evenodd" d="M1.867 12.324a.75.75 0 0 1 1.035-.232l8.964 5.685a.25.25 0 0 0 .268 0l8.964-5.685a.75.75 0 0 1 .804 1.267l-8.965 5.685a1.75 1.75 0 0 1-1.874 0l-8.965-5.685a.75.75 0 0 1-.231-1.035z"/><path fill-rule="evenodd" d="M1.867 16.324a.75.75 0 0 1 1.035-.232l8.964 5.685a.25.25 0 0 0 .268 0l8.964-5.685a.75.75 0 0 1 .804 1.267l-8.965 5.685a1.75 1.75 0 0 1-1.874 0l-8.965-5.685a.75.75 0 0 1-.231-1.035z"/></svg>

    </a>
    IOTstack - UKKOPAHIS-fork
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ukkopahis/IOTstack" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ukkopahis/IOTstack
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Basic setup
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Basic setup" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Basic setup
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Basic_setup/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Basic_setup/Accessing-your-Device-from-the-internet/" class="md-nav__link">
        Accessing your device from the internet
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Basic_setup/Backup-and-Restore/" class="md-nav__link">
        Backing up and restoring IOTstack
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Basic_setup/Custom/" class="md-nav__link">
        Custom overrides
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Basic_setup/Default-Configs/" class="md-nav__link">
        Default Passwords and ports
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Basic_setup/Docker/" class="md-nav__link">
        Docker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Basic_setup/Menu/" class="md-nav__link">
        Menu
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Basic_setup/Networking/" class="md-nav__link">
        Networking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Basic_setup/Troubleshooting/" class="md-nav__link">
        Troubleshooting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Basic_setup/Understanding-Containers/" class="md-nav__link">
        What is Docker?
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Basic_setup/What-is-sudo/" class="md-nav__link">
        What is sudo?
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Containers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Containers" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Containers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../AdGuardHome/" class="md-nav__link">
        AdGuard Home
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Adminer/" class="md-nav__link">
        Adminer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Blynk_server/" class="md-nav__link">
        Blynk server
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Chronograf/" class="md-nav__link">
        Chronograf
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../DashMachine/" class="md-nav__link">
        DashMachine
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Deconz/" class="md-nav__link">
        deCONZ
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../DiyHue/" class="md-nav__link">
        DIY hue
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Dozzle/" class="md-nav__link">
        Dozzle
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Duckdns/" class="md-nav__link">
        Duck DNS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../EspruinoHub/" class="md-nav__link">
        Espruinohub
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Grafana/" class="md-nav__link">
        Grafana
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Heimdall/" class="md-nav__link">
        Heimdall
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Home-Assistant/" class="md-nav__link">
        Home Assistant
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Homebridge/" class="md-nav__link">
        Homebridge
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Homer/" class="md-nav__link">
        Homer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../InfluxDB/" class="md-nav__link">
        InfluxDB
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../InfluxDB2/" class="md-nav__link">
        InfluxDB 2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Kapacitor/" class="md-nav__link">
        Kapacitor
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../MariaDB/" class="md-nav__link">
        MariaDB
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Mosquitto/" class="md-nav__link">
        Mosquitto
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../MotionEye/" class="md-nav__link">
        MotionEye
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../NextCloud/" class="md-nav__link">
        Nextcloud
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Node-RED/" class="md-nav__link">
        Node-RED
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Octoprint/" class="md-nav__link">
        Octoprint
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../OpenHab/" class="md-nav__link">
        openHAB
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Pi-hole/" class="md-nav__link">
        Pi-hole
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Plex/" class="md-nav__link">
        Plex
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Portainer-agent/" class="md-nav__link">
        Portainer agent
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Portainer-ce/" class="md-nav__link">
        Portainer CE
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../PostgreSQL/" class="md-nav__link">
        PostgreSQL
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Prometheus/" class="md-nav__link">
        Prometheus
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Python/" class="md-nav__link">
        Python
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../RTL_433-docker/" class="md-nav__link">
        RTL_433 Docker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Syncthing/" class="md-nav__link">
        Syncthing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../TasmoAdmin/" class="md-nav__link">
        TasmoAdmin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Telegraf/" class="md-nav__link">
        Telegraf
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Timescaledb/" class="md-nav__link">
        Timescaledb
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../WireGuard/" class="md-nav__link">
        WireGuard
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../X2go/" class="md-nav__link">
        x2go
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Zigbee2MQTT
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Zigbee2MQTT
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#quick-links" class="md-nav__link">
    Quick links
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    References
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#definitions" class="md-nav__link">
    Definitions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#basicProcess" class="md-nav__link">
    Basic process for new users
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prepareAdapter" class="md-nav__link">
    Prepare your Zigbee adapter
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#identifyAdapter" class="md-nav__link">
    Identify your Zigbee adapter
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    Configuration
  </a>
  
    <nav class="md-nav" aria-label="Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#envVars" class="md-nav__link">
    Environment variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#confFile" class="md-nav__link">
    Configuration file
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#verifyOperation" class="md-nav__link">
    Verifying basic operation
  </a>
  
    <nav class="md-nav" aria-label="Verifying basic operation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#checkStatus" class="md-nav__link">
    Checking status
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#checkLog" class="md-nav__link">
    Checking the log
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#checkMQTT" class="md-nav__link">
    Checking Mosquitto connectivity
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#connectGUI" class="md-nav__link">
    Connecting to the web GUI
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openShell" class="md-nav__link">
    Shell access to the container
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pullUpgrade" class="md-nav__link">
    Container maintenance
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#update202204" class="md-nav__link">
    Service definition change
  </a>
  
    <nav class="md-nav" aria-label="Service definition change">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#confExists" class="md-nav__link">
    pre-existing configuration file
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Zigbee2mqttassistant/" class="md-nav__link">
        Zigbee2Mqtt Assistant
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Developers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Developers" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Developers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Developers/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Developers/BuildStack-RandomPassword/" class="md-nav__link">
        Build Stack Random Services Password
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Developers/BuildStack-Services/" class="md-nav__link">
        Build Stack Services system
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Developers/Git-Setup/" class="md-nav__link">
        Git Setup
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Developers/Menu-System/" class="md-nav__link">
        Menu system
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Developers/PostBuild-Script/" class="md-nav__link">
        Postbuild BASH Script
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Updates
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Updates" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Updates
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Updates/" class="md-nav__link">
        Updating the project
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Updates/Changelog/" class="md-nav__link">
        Changelog
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Updates/New-Menu-Release-Notes/" class="md-nav__link">
        New IOTstack Menu
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Updates/gcgarner-migration/" class="md-nav__link">
        Migrating from gcgarner to SensorsIot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Updates/migration-network-change/" class="md-nav__link">
        Migration: network change
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#quick-links" class="md-nav__link">
    Quick links
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    References
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#definitions" class="md-nav__link">
    Definitions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#basicProcess" class="md-nav__link">
    Basic process for new users
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prepareAdapter" class="md-nav__link">
    Prepare your Zigbee adapter
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#identifyAdapter" class="md-nav__link">
    Identify your Zigbee adapter
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    Configuration
  </a>
  
    <nav class="md-nav" aria-label="Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#envVars" class="md-nav__link">
    Environment variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#confFile" class="md-nav__link">
    Configuration file
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#verifyOperation" class="md-nav__link">
    Verifying basic operation
  </a>
  
    <nav class="md-nav" aria-label="Verifying basic operation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#checkStatus" class="md-nav__link">
    Checking status
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#checkLog" class="md-nav__link">
    Checking the log
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#checkMQTT" class="md-nav__link">
    Checking Mosquitto connectivity
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#connectGUI" class="md-nav__link">
    Connecting to the web GUI
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openShell" class="md-nav__link">
    Shell access to the container
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pullUpgrade" class="md-nav__link">
    Container maintenance
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#update202204" class="md-nav__link">
    Service definition change
  </a>
  
    <nav class="md-nav" aria-label="Service definition change">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#confExists" class="md-nav__link">
    pre-existing configuration file
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
  <a href="https://github.com/ukkopahis/IOTstack/edit/master/docs/Containers/Zigbee2MQTT.md" title="Edit this page" class="md-content__button md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>



<h1 id="zigbee2mqtt">Zigbee2MQTT<a class="headerlink" href="#zigbee2mqtt" title="Permanent link">&para;</a></h1>
<h2 id="quick-links">Quick links<a class="headerlink" href="#quick-links" title="Permanent link">&para;</a></h2>
<ul>
<li>New users: <a href="#basicProcess">start here</a></li>
<li>Existing users: <a href="#update202204">Service definition change</a> (circa April 2022)</li>
</ul>
<h2 id="references">References<a class="headerlink" href="#references" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://www.zigbee2mqtt.io">Web Guide</a></li>
<li><a href="https://www.zigbee2mqtt.io/guide/adapters/#recommended">Supported adapters</a></li>
<li><a href="https://github.com/Koenkk/zigbee2mqtt">GitHub</a></li>
<li><a href="https://hub.docker.com/r/koenkk/zigbee2mqtt/tags">DockerHub</a></li>
</ul>
<h2 id="definitions">Definitions<a class="headerlink" href="#definitions" title="Permanent link">&para;</a></h2>
<ul>
<li>
<p><em>"compose file"</em> means the file at the path:</p>
<div class="language-text highlight"><pre><span></span><code>~/IOTstack/docker-compose.yml
</code></pre></div>
</li>
</ul>
<h2 id="basicProcess">Basic process for new users<a class="headerlink" href="#basicProcess" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p>Run the IOTstack menu and choose both "Mosquitto" and "Zigbee2MQTT". That adds the service definitions for both of those containers to your <em>compose file</em>.</p>
</li>
<li>
<p><a href="#prepareAdapter">Prepare your Zigbee adapter</a> by flashing its firmware.</p>
</li>
<li>Follow the steps in <a href="#identifyAdapter">Identify your Zigbee adapter</a> to work out how your adapter "mounts" on your Raspberry Pi, and edit your <em>compose file</em> to include that information.</li>
<li>
<p>The default environment variables assume:</p>
<ul>
<li>You are running Mosquitto and Zigbee2MQTT as IOTstack containers on the same computer; and</li>
<li>You want the Zigbee2MQTT web front end to be available on port 8080.</li>
</ul>
<p>This is a good basis for getting started. If it sounds like it will meet your needs, you will not need to make any changes. Otherwise, review the <a href="#envVars">environment variables</a> and make appropriate changes to the service definition in your <em>compose file</em>.</p>
</li>
<li>
<p>Bring up your stack: { #upStack }</p>
<div class="language-console highlight"><pre><span></span><code><span class="gp">$ </span><span class="nb">cd</span> ~/IOTstack
<span class="gp">$ </span>docker-compose up -d
</code></pre></div>
</li>
<li>
<p>Confirm that the Zigbee2MQTT container appears to be working correctly. You should:</p>
<ul>
<li><a href="#checkStatus">Check container status</a> to confirm that the container is running and stable, and is not in a restart loop;</li>
<li><a href="#checkLog">Check the container's log</a> for any errors, warnings or other evidence of malfunction; and</li>
<li><a href="#checkMQTT">Check inter-container connectivity</a> by verifying that the Zigbee2MQTT container is publishing MQTT messages to the Mosquitto broker.</li>
</ul>
</li>
<li>
<p><a href="#connectGUI">Connect to the web front end</a> and start adding your Zigbee devices.</p>
</li>
</ol>
<h2 id="prepareAdapter">Prepare your Zigbee adapter<a class="headerlink" href="#prepareAdapter" title="Permanent link">&para;</a></h2>
<p>Zigbee adapters usually need to be "flashed" before they can be used by Zigbee2MQTT. To prepare your adatper:</p>
<ol>
<li>Go to the <a href="https://www.zigbee2mqtt.io/guide/adapters/#recommended">supported adapters</a> page.</li>
<li>Find your adapter in the list.</li>
<li>Follow the instructions for flashing your adapter.</li>
</ol>
<p>Note:</p>
<ul>
<li>If you can't find your adapter in the list of supported devices, you may not be able to get the Zigbee2MQTT container to connect to it. This kind of problem is outside the scope of IOTstack. You will have to raise the issue with the <a href="https://www.zigbee2mqtt.io">Zigbee2MQTT</a> project.</li>
</ul>
<h2 id="identifyAdapter">Identify your Zigbee adapter<a class="headerlink" href="#identifyAdapter" title="Permanent link">&para;</a></h2>
<p>This section covers adapters that connect to your Raspberry Pi via USB.</p>
<blockquote>
<p>See <a href="https://www.zigbee2mqtt.io/advanced/remote-adapter/connect_to_a_remote_adapter.html">connect to a remote adapter</a> for information on connecting to adapters via TCP.</p>
</blockquote>
<p>Many USB Zigbee adapters mount as <code>/dev/ttyACM0</code> but this is not true for <em>all</em> adapters. In addition, if you have multiple devices connected to your Raspberry Pi that contend for a given device name, there are no guarantees that your Zigbee adapter will <em>always</em> be assigned the <em>same</em> name each time the device list is enumerated.</p>
<p>For those reasons, it is better to take the time to identify your Zigbee adapter in a manner that will be predictable, unique and reliable:</p>
<ol>
<li>If your Zigbee adapter is connected to your Raspberry Pi, disconnect it.</li>
<li>
<p>Run the following command (the option is the digit "1"):</p>
<div class="language-console highlight"><pre><span></span><code><span class="gp">$ </span>ls -1 /dev/serial/by-id
</code></pre></div>
<p>The possible response patterns are:</p>
<ul>
<li>
<p>An error message:</p>
<div class="language-text highlight"><pre><span></span><code>ls: cannot access &#39;/dev/serial/by-id&#39;: No such file or directory
</code></pre></div>
</li>
<li>
<p>A list of one or more lines where your Zigbee adapter is <strong>not</strong> present. Example:</p>
<div class="language-text highlight"><pre><span></span><code>usb-Silicon_Labs_CP2102N_USB_to_UART_Bridge_Controller_f068b8e7e82d4b119c0ee71fa1143ea0-if00-port0
</code></pre></div>
</li>
</ul>
<p>The actual response (error, or a list of devices) does not matter. You are simply establishing a baseline.</p>
</li>
<li>
<p>Connect your prepared Zigbee adapter to a USB port on your Raspberry Pi.</p>
</li>
<li>
<p>Repeat the same <code>ls</code> command from step 2. The response pattern should be different from step 2. The list should now contain your Zigbee adapter. Example:</p>
<div class="language-text highlight"><pre><span></span><code>usb-Silicon_Labs_CP2102N_USB_to_UART_Bridge_Controller_f068b8e7e82d4b119c0ee71fa1143ea0-if00-port0
usb-Texas_Instruments_TI_CC2531_USB_CDC___0X00125A00183F06C5-if00
</code></pre></div>
<p>The second line indicates a CC2531 adapter is attached to the Raspberry Pi.</p>
<p>If the response pattern does <strong>not</strong> change, it means the Raspberry Pi is unable to see your adapter. The two most common reasons are:</p>
<ol>
<li>Your adapter was not flashed correctly. Start over at <a href="#prepareAdapter">prepare your Zigbee adapter</a>.</li>
<li>
<p>Your adapter does not mount as a serial device. Try repeating steps 2 through 4 with the command:</p>
<div class="language-console highlight"><pre><span></span><code><span class="gp">$ </span>ls -1 /dev
</code></pre></div>
<p>to see if you can discover how your adapter attaches to your Raspberry Pi.</p>
<blockquote>
<p>One example is the Electrolama zig-a-zig-ah which attaches as <code>/dev/ttyUSB0</code>.</p>
</blockquote>
</li>
</ol>
</li>
<li>
<p>Use the output from the <code>ls</code> command in step 4 to form the absolute path to your Zigbee adapter. Example:</p>
<div class="language-text highlight"><pre><span></span><code>/dev/serial/by-id/usb-Texas_Instruments_TI_CC2531_USB_CDC___0X00125A00183F06C5-if00
</code></pre></div>
</li>
<li>
<p>Check your work like this (the option is the lower-case letter "l"):</p>
<div class="language-console highlight"><pre><span></span><code><span class="gp">$ </span>ls -l /dev/serial/by-id/usb-Texas_Instruments_TI_CC2531_USB_CDC___0X00125A00183F06C5-if00
<span class="go">lrwxrwxrwx 1 root root 13 Mar 31 19:49 dev/serial/by-id/usb-Texas_Instruments_TI_CC2531_USB_CDC___0X00125A00183F06C5-if00 -&gt; ../../ttyACM0</span>
</code></pre></div>
<p>What the output is telling you is that the <em>by-id</em> path is a symbolic link to <code>/dev/ttyACM0</code>. Although this <em>may</em> always be true on your Raspberry Pi, the only part that is actually <em>guaranteed</em> to be true is the <em>by-id</em> path, which is why you should use it.</p>
</li>
<li>
<p>Use your favourite text editor to open your <em>compose file</em>.</p>
</li>
<li>
<p>Find your <code>zigbee2mqtt</code> service definition and identify this line:</p>
<div class="language-yaml highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/dev/ttyAMA0:/dev/ttyACM0</span><span class="w"></span>
</code></pre></div>
<p>The default from the IOTstack template maps the <em>external</em> (Raspberry Pi) device <code>/dev/ttyAMA0</code> to the <em>internal</em> (Zigbee2MQTT container) device <code>/dev/ttyACM0</code>.</p>
<blockquote>
<p>On the Raspberry Pi, the <em>external</em> device <code>/dev/ttyAMA0</code> is the Bluetooth adapter. It was chosen as the default because it normally exists and its presence avoids sending Zigbee2MQTT into a restart loop if you start the container before completing these steps.</p>
</blockquote>
</li>
<li>
<p>Replace <code>/dev/ttyAMA0</code> with your <em>by-id</em> path. Example:</p>
<div class="language-yaml highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/dev/serial/by-id/usb-Texas_Instruments_TI_CC2531_USB_CDC___0X00125A00183F06C5-if00:/dev/ttyACM0</span><span class="w"></span>
</code></pre></div>
</li>
<li>
<p>Save your work.</p>
</li>
<li>Continue from <a href="#upStack">bring up your stack</a>.</li>
</ol>
<h2 id="configuration">Configuration<a class="headerlink" href="#configuration" title="Permanent link">&para;</a></h2>
<h3 id="envVars">Environment variables<a class="headerlink" href="#envVars" title="Permanent link">&para;</a></h3>
<p>Any value that can be set in a Zigbee2MQTT <a href="#confFile">configuration file</a> can also be set using an environment variable.</p>
<blockquote>
<p>The <a href="https://www.zigbee2mqtt.io/guide/configuration/#environment-variables">Zigbee2MQTT documentation</a> explains the syntax.</p>
</blockquote>
<p>Note:</p>
<ul>
<li>Do <strong>not</strong> use quote marks to enclose the values (right hand sides) of environment variables.</li>
</ul>
<p>Whenever you change the value of an environment variable, you also need to tell <code>docker-compose</code> to apply the change:</p>
<div class="language-console highlight"><pre><span></span><code><span class="gp">$ </span><span class="nb">cd</span> ~/IOTstack
<span class="gp">$ </span>docker-compose up -d zigbee2mqtt
</code></pre></div>
<p>The default service definition provided with IOTstack includes the following environment variables:</p>
<ul>
<li>
<p><code>TZ=Etc/UTC</code></p>
<p>You should replace <code>Etc/UTC</code> with a value that is correct for your location.</p>
</li>
<li>
<p><code>ZIGBEE2MQTT_CONFIG_MQTT_SERVER=mqtt://mosquitto:1883</code> { #mqttServer }</p>
<p>Typical values for this are:</p>
<ul>
<li>
<p><code>mqtt://mosquitto:1883</code></p>
<p>This is default value supplied with the IOTstack template. It assumes that both Zigbee2MQTT and the Mosquitto broker are running in non-host mode containers on the same Raspberry Pi.</p>
</li>
<li>
<p><code>mqtt://localhost:1883</code></p>
<p>This would be appropriate if you were to run Zigbee2MQTT in host mode and the Mosquitto broker was running on the same Raspberry Pi.</p>
</li>
<li>
<p><code>mqtt://«host-or-ip»:1883</code></p>
<p>If the Mosquitto broker is running on a <em>different</em> computer, replace <code>«host-or-ip»</code> with the IP address or domain name of that other computer. You should also remove or comment-out the following lines from the service definition:</p>
<div class="language-yaml highlight"><pre><span></span><code><span class="nt">depends_on</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mosquitto</span><span class="w"></span>
</code></pre></div>
<p>The <code>depends_on</code> clause ensures that the Mosquitto container starts alongside the Zigbee2MQTT container. That would not be appropriate if Mosquitto was running on a separate computer.</p>
</li>
</ul>
</li>
<li>
<p><code>ZIGBEE2MQTT_CONFIG_FRONTEND=true</code> { #frontEndEnable }</p>
<p>This variable activates the Zigbee2MQTT web interface on port 8080. If you want to change the port number where you access the Zigbee2MQTT web interface, see <a href="#connectGUI">connecting to the web GUI</a>.</p>
</li>
<li>
<p><code>ZIGBEE2MQTT_CONFIG_ADVANCED_LOG_SYMLINK_CURRENT=true</code> { #logSymlink }</p>
<p>Defining this variable causes Zigbee2MQTT to create a symlink pointing to the current log <strong>folder</strong> at the path:</p>
<div class="language-text highlight"><pre><span></span><code>~/IOTstack/volumes/zigbee2mqtt/data/log/current
</code></pre></div>
<p>See <a href="#checkLog">Checking the log</a> for more information about why this is useful.</p>
</li>
</ul>
<h3 id="confFile">Configuration file<a class="headerlink" href="#confFile" title="Permanent link">&para;</a></h3>
<p>Zigbee2MQTT creates a default configuration file at the path:</p>
<div class="language-text highlight"><pre><span></span><code>~/IOTstack/volumes/zigbee2mqtt/data/configuration.yaml
</code></pre></div>
<p>Although you <em>can</em> edit the configuration file, the approach recommended for IOTstack is to use <a href="#envVars">environment variables</a>.</p>
<p>If you decide to edit the configuration file:</p>
<ol>
<li>You will need to use <code>sudo</code> to edit the file.</li>
<li>
<p>After you have finished making changes, you need to inform the running container by:</p>
<div class="language-console highlight"><pre><span></span><code><span class="gp">$ </span><span class="nb">cd</span> ~/IOTstack
<span class="gp">$ </span>docker-compose restart zigbee2mqtt
</code></pre></div>
</li>
<li>
<p><a href="#checkLog">Check the log</a> for errors.</p>
</li>
</ol>
<p>Note:</p>
<ul>
<li>If you start Zigbee2MQTT from a clean slate (ie where the configuration file does not exist) <strong>and</strong> your <em>compose file</em> does not define the <a href="#mqttServer"><code>… MQTT_SERVER</code></a> environment variable discussed above, the container will go into a restart loop. This happens because the Zigbee2MQTT container defaults to trying to reach the Mosquitto broker at <code>localhost:1883</code> instead of <code>mosquitto:1883</code>. That usually fails.</li>
</ul>
<h2 id="verifyOperation">Verifying basic operation<a class="headerlink" href="#verifyOperation" title="Permanent link">&para;</a></h2>
<h3 id="checkStatus">Checking status<a class="headerlink" href="#checkStatus" title="Permanent link">&para;</a></h3>
<div class="language-console highlight"><pre><span></span><code><span class="gp">$ </span>docker ps <span class="p">|</span> grep -e mosquitto -e zigbee2mqtt
<span class="go">NAMES         CREATED          STATUS</span>
<span class="go">zigbee2mqtt   33 seconds ago   Up 30 seconds</span>
<span class="go">mosquitto     33 seconds ago   Up 31 seconds (healthy)</span>
</code></pre></div>
<blockquote>
<p>The above output is filtered down to the relevant columns</p>
</blockquote>
<p>You are looking for evidence that the container is restarting (ie the "Status" column only ever shows a low number of seconds when compared with the "Created" column).</p>
<h3 id="checkLog">Checking the log<a class="headerlink" href="#checkLog" title="Permanent link">&para;</a></h3>
<p>You can't use <code>docker logs zigbee2mqtt</code> to inspect the Zigbee2MQTT container's logs. That's because Zigbee2MQTT writes its logging information to the path:</p>
<div class="language-text highlight"><pre><span></span><code>~/IOTstack/volumes/zigbee2mqtt/data/log/yyyy-mm-dd.hh-mm-ss/log.txt
</code></pre></div>
<p>where <code>yyyy-mm-dd.hh-mm-ss</code> is the date and time the container was last started. This means that you have to identify the folder with the latest timestamp before you can inspect the log contained within it.</p>
<p>Fortunately, Zigbee2MQTT offers a shortcut. If the <a href="#logSymlink"><code>… LOG_SYMLINK_CURRENT</code></a> environment variable is <code>true</code> then the path to the <em>current</em> log will be:</p>
<div class="language-text highlight"><pre><span></span><code>~/IOTstack/volumes/zigbee2mqtt/data/log/current/log.txt
</code></pre></div>
<p>You can use commands like <code>cat</code> and <code>tail</code> to examine the <em>current</em> log. Example:</p>
<div class="language-console highlight"><pre><span></span><code><span class="gp">$ </span>cat ~/IOTstack/volumes/zigbee2mqtt/data/log/current/log.txt
</code></pre></div>
<h3 id="checkMQTT">Checking Mosquitto connectivity<a class="headerlink" href="#checkMQTT" title="Permanent link">&para;</a></h3>
<p>To perform this check, you will need to have the Mosquitto clients installed:</p>
<div class="language-console highlight"><pre><span></span><code><span class="gp">$ </span>sudo apt install -y mosquitto-clients
</code></pre></div>
<p>The Mosquitto clients package includes two command-line tools:</p>
<ul>
<li><code>mosquitto_pub</code> for publishing MQTT messages to the broker; and</li>
<li>
<p><code>mosquitto_sub</code> for subscribing to MQTT messages distributed by the broker.</p>
<blockquote>
<p>In IOTstack, the "broker" is usually the Mosquitto container.</p>
</blockquote>
</li>
</ul>
<p>Assuming the Mosquitto clients are installed, you can run the following command:</p>
<div class="language-console highlight"><pre><span></span><code><span class="gp">$ </span>mosquitto_sub -v -h <span class="s2">&quot;localhost&quot;</span> -t <span class="s2">&quot;zigbee2mqtt/#&quot;</span> -F <span class="s2">&quot;%I %t %p&quot;</span>
</code></pre></div>
<p>One of two things will happen:</p>
<ul>
<li><em>silence,</em> indicating that the Zigbee2MQTT container is <strong>not</strong> able to communicate with the Mosquitto container. If this happens, you should <a href="#checkLog">check the Zigbee2MQTT log</a>. </li>
<li><em>chatter,</em> proving that the Zigbee2MQTT container <strong>can</strong> communicate with the Mosquitto container.</li>
</ul>
<p>Terminate the <code>mosquitto_sub</code> command with a <kbd>Control</kbd><kbd>c</kbd>.</p>
<h2 id="connectGUI">Connecting to the web GUI<a class="headerlink" href="#connectGUI" title="Permanent link">&para;</a></h2>
<p>Open a browser, and point it to port 8080 on your Raspberry Pi. For example:</p>
<div class="language-text highlight"><pre><span></span><code>http://raspberrypi.local:8080
</code></pre></div>
<p>You should see the Zigbee2MQTT interface.</p>
<p>Notes:</p>
<ol>
<li>
<p>The availability of the Zigbee2MQTT UI is governed by an environment variable. If you do not see the UI, check that <a href="#frontEndEnable"><code>… FRONTEND</code></a> is defined.</p>
</li>
<li>
<p>In the URL above, port 8080 is an <strong>external</strong> port which is exposed via the following port mapping in the Zigbee2MQTT service definition:</p>
<div class="language-yaml highlight"><pre><span></span><code><span class="nt">ports</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;8080:8080&quot;</span><span class="w"></span>
</code></pre></div>
<p>If you want to reach the Zigbee2MQTT UI via a different port, you should edit the left hand side of that mapping. For example, if you wanted to use port 10080 you would write: </p>
<div class="language-yaml highlight"><pre><span></span><code><span class="nt">ports</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;10080:8080&quot;</span><span class="w"></span>
</code></pre></div>
<p>Do not change the <em>internal</em> port number on the right hand side of the mapping. To apply changes to the port mapping:</p>
<div class="language-console highlight"><pre><span></span><code><span class="gp">$ </span><span class="nb">cd</span> ~/IOTstack
<span class="gp">$ </span>docker-compose up -d zigbee2mqtt
</code></pre></div>
</li>
</ol>
<h2 id="openShell">Shell access to the container<a class="headerlink" href="#openShell" title="Permanent link">&para;</a></h2>
<p>To open a shell inside the Zigbee2MQTT container, run:</p>
<div class="language-console highlight"><pre><span></span><code><span class="gp">$ </span>docker <span class="nb">exec</span> -it zigbee2mqtt ash
</code></pre></div>
<blockquote>
<p><code>ash</code> is <strong>not</strong> a typo!</p>
</blockquote>
<p>To close the shell and leave the container, either type "exit" and press <kbd>return</kbd>, or press <kbd>Control</kbd><kbd>d</kbd>.</p>
<h2 id="pullUpgrade">Container maintenance<a class="headerlink" href="#pullUpgrade" title="Permanent link">&para;</a></h2>
<p>When you become aware of a new version of Zigbee2MQTT on <a href="https://hub.docker.com/r/koenkk/zigbee2mqtt/tags">DockerHub</a>, do the following:</p>
<div class="language-console highlight"><pre><span></span><code><span class="gp">$ </span><span class="nb">cd</span> ~IOTstack
<span class="gp">$ </span>docker-compose pull zigbee2mqtt
<span class="gp">$ </span>docker-compose up -d zigbee2mqtt
<span class="gp">$ </span>docker system prune
</code></pre></div>
<p>In words:</p>
<ol>
<li>Be in the correct directory.</li>
<li>The <code>pull</code> compares the version on your Raspberry Pi with the latest version on <a href="https://hub.docker.com/r/koenkk/zigbee2mqtt/tags">DockerHub</a>, and downloads any later version.</li>
<li>If a newer version is downloaded, the <code>up</code> instantiates a new container based on the new image and performs a new-for-old swap. There is barely any downtime.</li>
<li>The <code>prune</code> cleans up the older image.</li>
</ol>
<p>You can omit the <code>zigbee2mqtt</code> arguments from the <code>pull</code> and <code>up</code> commands, in which case <code>docker-compose</code> makes an attempt to pull any available updates for all non-Dockerfile-based images, and then instantiates any new images it has downloaded.</p>
<h2 id="update202204">Service definition change<a class="headerlink" href="#update202204" title="Permanent link">&para;</a></h2>
<p>This information is for existing users of the Zigbee2MQTT container.</p>
<p>The default IOTstack service definition for Zigbee2MQTT has changed:</p>
<ul>
<li>The container no longer needs to be built using a Dockerfile.</li>
<li>The Zigbee2MQTT images on <a href="https://hub.docker.com/r/koenkk/zigbee2mqtt/tags">DockerHub</a> can be used "as is".</li>
<li>Environment variables supplied with the updated service definition exactly replicate the purpose of the old Dockerfile. </li>
<li>The Dockerfile supplied with the IOTstack template is deprecated but continues to be provided to maintain backwards compatibility and to avoid introducing a breaking change.</li>
</ul>
<p>If you were using the Zigbee2MQTT container in IOTstack before April 2022, you should use your favourite text editor to update your <em>compose file</em> to conform with the new service definition.</p>
<blockquote>
<p>You <em>could</em> run the menu, then de-select and re-select Zigbee2MQTT. That <em>will</em> have the effect of applying the updated service definition but it also risks overwriting any other customisations you may have in place. That is why editing your <em>compose file</em> is the recommended approach.</p>
</blockquote>
<p>The updated service definition is included here for ease of reference:</p>
<div class="language-yaml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">zigbee2mqtt</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">zigbee2mqtt</span><span class="w"></span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">koenkk/zigbee2mqtt:latest</span><span class="w"></span>
<span class="w">  </span><span class="nt">environment</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TZ=Etc/UTC</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ZIGBEE2MQTT_CONFIG_MQTT_SERVER=mqtt://mosquitto:1883</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ZIGBEE2MQTT_CONFIG_FRONTEND=true</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ZIGBEE2MQTT_CONFIG_ADVANCED_LOG_SYMLINK_CURRENT=true</span><span class="w"></span>
<span class="w">  </span><span class="nt">ports</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;8080:8080&quot;</span><span class="w"></span>
<span class="w">  </span><span class="nt">volumes</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./volumes/zigbee2mqtt/data:/app/data</span><span class="w"></span>
<span class="w">  </span><span class="nt">devices</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/dev/ttyAMA0:/dev/ttyACM0</span><span class="w"></span>
<span class="w">  </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unless-stopped</span><span class="w"></span>
<span class="w">  </span><span class="nt">depends_on</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mosquitto</span><span class="w"></span>
</code></pre></div></td></tr></table></div>
<p>The changes you should make to your existing Zigbee2MQTT service definition are:</p>
<ol>
<li>
<p>Replace the <code>build</code> directive:</p>
<div class="language-yaml highlight"><pre><span></span><code><span class="nt">build</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./.templates/zigbee2mqtt/.</span><span class="w"></span>
</code></pre></div>
<p>with this <code>image</code> directive:</p>
<div class="language-yaml highlight"><pre><span></span><code><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">koenkk/zigbee2mqtt:latest</span><span class="w"></span>
</code></pre></div>
<p>This causes IOTstack to use Zigbee2MQTT images "as is" from <a href="https://hub.docker.com/r/koenkk/zigbee2mqtt/tags">DockerHub</a>.</p>
</li>
<li>
<p>Add these environment variables:</p>
<div class="language-yaml highlight"><pre><span></span><code><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ZIGBEE2MQTT_CONFIG_MQTT_SERVER=mqtt://mosquitto:1883</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ZIGBEE2MQTT_CONFIG_FRONTEND=true</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ZIGBEE2MQTT_CONFIG_ADVANCED_LOG_SYMLINK_CURRENT=true</span><span class="w"></span>
</code></pre></div>
<p>The first two have the <strong>identical</strong> effect to the changes previously made via the Dockerfile. The last variable makes it easier for you to find and <a href="#checkLog">view the current log</a>.</p>
<p>See <a href="#envVars">environment variables</a> for more detail.</p>
</li>
<li>
<p>Add the dependency clause:</p>
<div class="language-yaml highlight"><pre><span></span><code><span class="nt">depends_on</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mosquitto</span><span class="w"></span>
</code></pre></div>
<p>This ensures the Mosquitto container is brought up alongside Zigbee2MQTT. The Zigbee2MQTT container goes into a restart loop if Mosquitto is not reachable so this change enforces that business rule. See <a href="#mqttServer"><code>… MQTT_SERVER</code></a> for the situation where this might not be appropriate.</p>
</li>
</ol>
<h3 id="confExists">pre-existing configuration file<a class="headerlink" href="#confExists" title="Permanent link">&para;</a></h3>
<p>Environment variables in your <em>compose file</em> override corresponding values set in the <em>configuration file</em> at:</p>
<div class="language-text highlight"><pre><span></span><code>~/IOTstack/volumes/zigbee2mqtt/data/configuration.yaml
</code></pre></div>
<p>If you have customised your existing Zigbee2MQTT <a href="#confFile">configuration file</a>, you should review your settings for potential conflicts with the environment variables introduced by the changes to the IOTstack service definition. You can resolve any conflicts either by:</p>
<ul>
<li>removing or commenting-out conflicting environment variables; or</li>
<li>altering the environment variable values to match your configuration file.</li>
</ul>
<p>The second approach is recommended because it minimises the risk that Zigbee2MQTT will go into a restart loop if the configuration file is not present when the container starts.</p>
<p>As the <a href="https://www.zigbee2mqtt.io/guide/configuration/#environment-variables">Zigbee2MQTT documentation</a> explains, any option that can be set in a configuration file can also be set using an environment variable, so you may want to take the opportunity to implement all your settings as environment variables.</p>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../X2go/" class="md-footer__link md-footer__link--prev" aria-label="Previous: x2go" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              x2go
            </div>
          </div>
        </a>
      
      
        
        <a href="../Zigbee2mqttassistant/" class="md-footer__link md-footer__link--next" aria-label="Next: Zigbee2Mqtt Assistant" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Zigbee2Mqtt Assistant
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.annotate", "tabs", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections"], "search": "../../assets/javascripts/workers/search.2a1c317c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.ed9748b7.min.js"></script>
      
        <script src="../../javascript/fix-codeblock-console-copy-button.js"></script>
      
    
  </body>
</html>