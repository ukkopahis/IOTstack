
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Docker stack for getting started on IOT on the Raspberry PI">
      
      
      
      <link rel="icon" href="../../stack-24.svg">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.2.13">
    
    
      
        <title>Pi-hole - IOTstack - UKKOPAHIS-fork</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.e411adfe.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cc9b2e1e.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../style.css">
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#pi-hole" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="IOTstack - UKKOPAHIS-fork" class="md-header__button md-logo" aria-label="IOTstack - UKKOPAHIS-fork" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M11.063 1.456a1.75 1.75 0 0 1 1.874 0l8.383 5.316a1.75 1.75 0 0 1 0 2.956l-8.383 5.316a1.75 1.75 0 0 1-1.874 0L2.68 9.728a1.75 1.75 0 0 1 0-2.956l8.383-5.316zm1.071 1.267a.25.25 0 0 0-.268 0L3.483 8.039a.25.25 0 0 0 0 .422l8.383 5.316a.25.25 0 0 0 .268 0l8.383-5.316a.25.25 0 0 0 0-.422l-8.383-5.316z"/><path fill-rule="evenodd" d="M1.867 12.324a.75.75 0 0 1 1.035-.232l8.964 5.685a.25.25 0 0 0 .268 0l8.964-5.685a.75.75 0 0 1 .804 1.267l-8.965 5.685a1.75 1.75 0 0 1-1.874 0l-8.965-5.685a.75.75 0 0 1-.231-1.035z"/><path fill-rule="evenodd" d="M1.867 16.324a.75.75 0 0 1 1.035-.232l8.964 5.685a.25.25 0 0 0 .268 0l8.964-5.685a.75.75 0 0 1 .804 1.267l-8.965 5.685a1.75 1.75 0 0 1-1.874 0l-8.965-5.685a.75.75 0 0 1-.231-1.035z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            IOTstack - UKKOPAHIS-fork
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Pi-hole
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/ukkopahis/IOTstack" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ukkopahis/IOTstack
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../Basic_setup/" class="md-tabs__link">
        Basic setup
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../AdGuardHome/" class="md-tabs__link md-tabs__link--active">
        Containers
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../Developers/" class="md-tabs__link">
        Developers
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../Updates/" class="md-tabs__link">
        Updates
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="IOTstack - UKKOPAHIS-fork" class="md-nav__button md-logo" aria-label="IOTstack - UKKOPAHIS-fork" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M11.063 1.456a1.75 1.75 0 0 1 1.874 0l8.383 5.316a1.75 1.75 0 0 1 0 2.956l-8.383 5.316a1.75 1.75 0 0 1-1.874 0L2.68 9.728a1.75 1.75 0 0 1 0-2.956l8.383-5.316zm1.071 1.267a.25.25 0 0 0-.268 0L3.483 8.039a.25.25 0 0 0 0 .422l8.383 5.316a.25.25 0 0 0 .268 0l8.383-5.316a.25.25 0 0 0 0-.422l-8.383-5.316z"/><path fill-rule="evenodd" d="M1.867 12.324a.75.75 0 0 1 1.035-.232l8.964 5.685a.25.25 0 0 0 .268 0l8.964-5.685a.75.75 0 0 1 .804 1.267l-8.965 5.685a1.75 1.75 0 0 1-1.874 0l-8.965-5.685a.75.75 0 0 1-.231-1.035z"/><path fill-rule="evenodd" d="M1.867 16.324a.75.75 0 0 1 1.035-.232l8.964 5.685a.25.25 0 0 0 .268 0l8.964-5.685a.75.75 0 0 1 .804 1.267l-8.965 5.685a1.75 1.75 0 0 1-1.874 0l-8.965-5.685a.75.75 0 0 1-.231-1.035z"/></svg>

    </a>
    IOTstack - UKKOPAHIS-fork
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ukkopahis/IOTstack" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ukkopahis/IOTstack
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Basic setup
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Basic setup" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Basic setup
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Basic_setup/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Basic_setup/Accessing-your-Device-from-the-internet/" class="md-nav__link">
        Accessing your device from the internet
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Basic_setup/Backup-and-Restore/" class="md-nav__link">
        Backing up and restoring IOTstack
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Basic_setup/Custom/" class="md-nav__link">
        Custom overrides
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Basic_setup/Default-Configs/" class="md-nav__link">
        Default Passwords and ports
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Basic_setup/Docker/" class="md-nav__link">
        Docker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Basic_setup/Menu/" class="md-nav__link">
        Menu
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Basic_setup/Networking/" class="md-nav__link">
        Networking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Basic_setup/Troubleshooting/" class="md-nav__link">
        Troubleshooting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Basic_setup/Understanding-Containers/" class="md-nav__link">
        What is Docker?
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Basic_setup/What-is-sudo/" class="md-nav__link">
        What is sudo?
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Containers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Containers" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Containers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../AdGuardHome/" class="md-nav__link">
        AdGuard Home
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Adminer/" class="md-nav__link">
        Adminer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Blynk_server/" class="md-nav__link">
        Blynk server
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Chronograf/" class="md-nav__link">
        Chronograf
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../DashMachine/" class="md-nav__link">
        DashMachine
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Deconz/" class="md-nav__link">
        deCONZ
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../DiyHue/" class="md-nav__link">
        DIY hue
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Dozzle/" class="md-nav__link">
        Dozzle
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Duckdns/" class="md-nav__link">
        Duck DNS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../EspruinoHub/" class="md-nav__link">
        Espruinohub
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Grafana/" class="md-nav__link">
        Grafana
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Heimdall/" class="md-nav__link">
        Heimdall
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Home-Assistant/" class="md-nav__link">
        Home Assistant
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Homebridge/" class="md-nav__link">
        Homebridge
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Homer/" class="md-nav__link">
        Homer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../InfluxDB/" class="md-nav__link">
        InfluxDB
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../InfluxDB2/" class="md-nav__link">
        InfluxDB 2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Kapacitor/" class="md-nav__link">
        Kapacitor
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../MariaDB/" class="md-nav__link">
        MariaDB
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Mosquitto/" class="md-nav__link">
        Mosquitto
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../MotionEye/" class="md-nav__link">
        MotionEye
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../NextCloud/" class="md-nav__link">
        Nextcloud
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Node-RED/" class="md-nav__link">
        Node-RED
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Octoprint/" class="md-nav__link">
        Octoprint
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../OpenHab/" class="md-nav__link">
        openHAB
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Pi-hole
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Pi-hole
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    References
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#envVars" class="md-nav__link">
    Environment variables
  </a>
  
    <nav class="md-nav" aria-label="Environment variables">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#adminPassword" class="md-nav__link">
    Admin password
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#otherVars" class="md-nav__link">
    Other variables
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#webGUI" class="md-nav__link">
    Pi-hole Web GUI
  </a>
  
    <nav class="md-nav" aria-label="Pi-hole Web GUI">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#connectGUI" class="md-nav__link">
    Connecting to the GUI
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#localNames" class="md-nav__link">
    Adding local domain names
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rpiDNS" class="md-nav__link">
    Configure the Raspberry Pi to use Pi-hole
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configure-pi-hole-as-your-local-dns-resolver" class="md-nav__link">
    Configure Pi-hole as your local DNS resolver
  </a>
  
    <nav class="md-nav" aria-label="Configure Pi-hole as your local DNS resolver">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rpiFixedIP" class="md-nav__link">
    1. Assign the RPi a fixed IP address
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rpiConfig" class="md-nav__link">
    2. Configuring other machines to use the Raspberry Pi running Pi-hole
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#debugging" class="md-nav__link">
    Testing and Troubleshooting
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iotConfig" class="md-nav__link">
    Microcontrollers
  </a>
  
    <nav class="md-nav" aria-label="Microcontrollers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#esp32mDNS" class="md-nav__link">
    *.local won't work for ESPhome
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cleanSlate" class="md-nav__link">
    Getting a clean slate
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Plex/" class="md-nav__link">
        Plex
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Portainer-agent/" class="md-nav__link">
        Portainer agent
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Portainer-ce/" class="md-nav__link">
        Portainer CE
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../PostgreSQL/" class="md-nav__link">
        PostgreSQL
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Prometheus/" class="md-nav__link">
        Prometheus
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Python/" class="md-nav__link">
        Python
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../RTL_433-docker/" class="md-nav__link">
        RTL_433 Docker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Syncthing/" class="md-nav__link">
        Syncthing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../TasmoAdmin/" class="md-nav__link">
        TasmoAdmin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Telegraf/" class="md-nav__link">
        Telegraf
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Timescaledb/" class="md-nav__link">
        Timescaledb
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../WireGuard/" class="md-nav__link">
        WireGuard
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../X2go/" class="md-nav__link">
        x2go
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Zigbee2MQTT/" class="md-nav__link">
        Zigbee2MQTT
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Zigbee2mqttassistant/" class="md-nav__link">
        Zigbee2Mqtt Assistant
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Developers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Developers" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Developers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Developers/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Developers/BuildStack-RandomPassword/" class="md-nav__link">
        Build Stack Random Services Password
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Developers/BuildStack-Services/" class="md-nav__link">
        Build Stack Services system
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Developers/Git-Setup/" class="md-nav__link">
        Git Setup
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Developers/Menu-System/" class="md-nav__link">
        Menu system
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Developers/PostBuild-Script/" class="md-nav__link">
        Postbuild BASH Script
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Updates
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Updates" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Updates
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Updates/" class="md-nav__link">
        Updating the project
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Updates/Changelog/" class="md-nav__link">
        Changelog
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Updates/New-Menu-Release-Notes/" class="md-nav__link">
        New IOTstack Menu
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Updates/gcgarner-migration/" class="md-nav__link">
        Migrating from gcgarner to SensorsIot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Updates/migration-network-change/" class="md-nav__link">
        Migration: network change
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    References
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#envVars" class="md-nav__link">
    Environment variables
  </a>
  
    <nav class="md-nav" aria-label="Environment variables">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#adminPassword" class="md-nav__link">
    Admin password
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#otherVars" class="md-nav__link">
    Other variables
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#webGUI" class="md-nav__link">
    Pi-hole Web GUI
  </a>
  
    <nav class="md-nav" aria-label="Pi-hole Web GUI">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#connectGUI" class="md-nav__link">
    Connecting to the GUI
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#localNames" class="md-nav__link">
    Adding local domain names
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rpiDNS" class="md-nav__link">
    Configure the Raspberry Pi to use Pi-hole
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configure-pi-hole-as-your-local-dns-resolver" class="md-nav__link">
    Configure Pi-hole as your local DNS resolver
  </a>
  
    <nav class="md-nav" aria-label="Configure Pi-hole as your local DNS resolver">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rpiFixedIP" class="md-nav__link">
    1. Assign the RPi a fixed IP address
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rpiConfig" class="md-nav__link">
    2. Configuring other machines to use the Raspberry Pi running Pi-hole
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#debugging" class="md-nav__link">
    Testing and Troubleshooting
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iotConfig" class="md-nav__link">
    Microcontrollers
  </a>
  
    <nav class="md-nav" aria-label="Microcontrollers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#esp32mDNS" class="md-nav__link">
    *.local won't work for ESPhome
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cleanSlate" class="md-nav__link">
    Getting a clean slate
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
  <a href="https://github.com/ukkopahis/IOTstack/edit/master/docs/Containers/Pi-hole.md" title="Edit this page" class="md-content__button md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>



<h1 id="pi-hole">Pi-hole<a class="headerlink" href="#pi-hole" title="Permanent link">&para;</a></h1>
<p>Pi-hole is a fantastic utility to reduce ads.</p>
<h2 id="references">References<a class="headerlink" href="#references" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://github.com/pi-hole/docker-pi-hole">Pi-hole on GitHub</a></li>
<li><a href="https://hub.docker.com/r/pihole/pihole">Pi-hole on Dockerhub</a></li>
<li><a href="https://github.com/pi-hole/docker-pi-hole#environment-variables">Pi-hole environment variables</a></li>
</ul>
<h2 id="envVars">Environment variables<a class="headerlink" href="#envVars" title="Permanent link">&para;</a></h2>
<p>In conjunction with controls in Pi-hole's web GUI, environment variables govern much of Pi-hole's behaviour. If you are running new menu (master branch), the variables are inline in <code>docker-compose.yml</code>. If you are running old menu, the variables will be in <code>~/IOTstack/services/pihole/pihole.env</code></p>
<blockquote>
<p>There is nothing about old menu which <em>requires</em> the variables to be stored in the <code>pihole.env</code> file. You can migrate everything to <code>docker-compose.yml</code> if you wish.</p>
</blockquote>
<p>Pi-hole's authoritative list of environment variables can be found <a href="https://github.com/pi-hole/docker-pi-hole#environment-variables">here</a>. Although many of Pi-hole's options can be set through its web GUI, there are two key advantages to using environment variables:</p>
<ol>
<li>If you ever need to reset Pi-hole by <a href="#cleanSlate">erasing its persistent storage area</a>, configuration options set using environment variables will persist while those set through the GUI may be lost; and</li>
<li>On at least two occasions in its history, Pi-hole upgrades have had the effect of wiping configuration options set through the GUI, whereas options set using environment variables survived. </li>
</ol>
<h3 id="adminPassword">Admin password<a class="headerlink" href="#adminPassword" title="Permanent link">&para;</a></h3>
<p>The first time Pi-hole is launched, it checks for the <code>WEBPASSWORD</code> environment variable. If found, the right hand side becomes the administrative password.</p>
<p>You can set the value of <code>WEBPASSWORD</code> in the IOTstack menu by:</p>
<ol>
<li>Placing the cursor on top of "pihole".</li>
<li>If Pi-hole is not already selected as a container, press <kbd>space</kbd> to select it.</li>
<li>Press the right arrow, and then</li>
<li>Choose "PiHole Password Options".</li>
</ol>
<p>From there, you have the choice of:</p>
<ul>
<li>
<p><em>Use default password for this build</em></p>
<p>Choosing this option results in:</p>
<div class="language-yaml highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">WEBPASSWORD=IOtSt4ckP1Hol3</span><span class="w"></span>
</code></pre></div>
</li>
<li>
<p><em>Randomise password for this build</em></p>
<p>Choosing this option results in a randomly-generated password which you can find by inspecting your <code>docker-compose.yml</code>.</p>
</li>
<li>
<p><em>Do nothing</em></p>
<p>Choosing this option results in:</p>
<div class="language-yaml highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">WEBPASSWORD=%randomAdminPassword%</span><span class="w"></span>
</code></pre></div>
<p>which is a valid password string so "%randomAdminPassword%" will become the password.</p>
</li>
</ul>
<p>Regardless of which option you choose, you can always edit your <code>docker-compose.yml</code> to change the value of the environment variable. For example:</p>
<div class="language-yaml highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">WEBPASSWORD=mybigsecret</span><span class="w"></span>
</code></pre></div>
<p>It is important to realise that <code>WEBPASSWORD</code> only has any effect on the very <strong>first</strong> launch. Once Pi-hole has been run at least once, the value of <code>WEBPASSWORD</code> is ignored and any changes you make will have no effect.</p>
<p>If <code>WEBPASSWORD</code> is <strong>not</strong> set on first launch, Pi-hole defaults to a randomly-generated password which you can discover after the first launch like this:</p>
<div class="language-console highlight"><pre><span></span><code><span class="gp">$ </span>docker logs pihole <span class="p">|</span> grep random 
</code></pre></div>
<blockquote>
<p>Remember, docker logs are ephemeral so you need to run that command before the log disappears!</p>
</blockquote>
<p>If you ever need to reset Pi-hole's admin password to a known value, use the following command:</p>
<div class="language-console highlight"><pre><span></span><code><span class="gp">$ </span>docker <span class="nb">exec</span> pihole pihole -a -p mybigsecret
</code></pre></div>
<blockquote>
<p>replacing "mybigsecret" with your choice of password.</p>
</blockquote>
<h3 id="otherVars">Other variables<a class="headerlink" href="#otherVars" title="Permanent link">&para;</a></h3>
<p>Most of Pi-hole's environment variables are self-explanatory but some can benefit from elaboration.</p>
<details class="info">
<summary>(advanced) reverse DNS query handling</summary>
<p>First, understand that there are two basic types of DNS query:</p>
<ul>
<li>
<p><em>forward queries</em>:</p>
<ul>
<li>question: "what is the IP address of fred.yourdomain.com?"</li>
<li>answer: 192.168.1.100</li>
</ul>
</li>
<li>
<p><em>reverse queries</em>:</p>
<ul>
<li>question: "what is the domain name for 192.168.1.100?"</li>
<li>answer: fred.yourdomain.com</li>
</ul>
</li>
</ul>
<p>Pi-hole has its own built-in DNS server which can answer both kinds of queries. The implementation is useful but doesn't offer all the features of a full-blown DNS server like BIND9. If you decide to implement a more capable DNS server to work alongside Pi-hole, you will need to understand the following Pi-hole environment variables:</p>
<ul>
<li>
<p><code>REV_SERVER=</code></p>
<p>If you configure Pi-hole's built-in DNS server to be authoritative for your local domain name, <code>REV_SERVER=false</code> is appropriate, in which case none of the variables discussed below has any effect.</p>
<p>Setting <code>REV_SERVER=true</code> allows Pi-hole to forward queries that it can't answer to a local upstream DNS server, typically running inside your network.</p>
</li>
<li>
<p><code>REV_SERVER_DOMAIN=yourdomain.com</code> (where "yourdomain.com" is an example)</p>
<p>The Pi-hole documentation says:</p>
<blockquote>
<p><em>"If conditional forwarding is enabled, set the domain of the local network router".</em></p>
</blockquote>
<p>The words "if conditional forwarding is enabled" mean "when <code>REV_SERVER=true</code>".</p>
<p>However, this option really has little-to-nothing to do with the "domain of the local network <strong>router</strong>". Your router <em>may</em> have an IP address that reverse-resolves to a local domain name (eg gateway.mydomain.com) but this is something most routers are unaware of, even if you have configured your router's DHCP server to inform clients that they should assume a default domain of "yourdomain.com".</p>
<p>This variable actually tells Pi-hole the name of your local domain. In other words, it tells Pi-hole to consider the possibility that an <em>unqualified</em> name like "fred" could be the fully-qualified domain name "fred.yourdomain.com".</p>
</li>
<li>
<p><code>REV_SERVER_TARGET=192.168.1.5</code> (where 192.168.1.5 is an example):</p>
<p>The Pi-hole documentation says:</p>
<blockquote>
<p><em>"If conditional forwarding is enabled, set the IP of the local network router".</em></p>
</blockquote>
<p>This option tells Pi-hole where to direct <em>forward queries</em> that it can't answer. In other words, Pi-hole will send a forward query for fred.yourdomain.com to 192.168.1.5.</p>
<p>It <em>may</em> be appropriate to set <code>REV_SERVER_TARGET</code> to the IP address of your router (eg 192.168.1.1) but, unless your router is running as a DNS server (not impossible but uncommon), the router will likely just relay any queries to your ISP's DNS servers (or other well-known DNS servers like 8.8.8.8 or 1.1.1.1 if you have configured those). Those external DNS servers are unlikely to be able to resolve queries for names in your private domain, and won't be able to do anything sensible with reverse queries if your home network uses RFC1918 addressing (which most do: 182.168.x.x being the most common example).</p>
<p>Forwarding doesn't guarantee that 192.168.1.5 will be able to answer the query. The DNS server at 192.168.1.5 may well relay the query to yet another server. In other words, this environment variable does no more than set the next hop.</p>
<p>If you are planning on using this option, the target needs to be a DNS server that is authoritative for your local domain and that, pretty much, is going to be a local upstream DNS server inside your home network like another Raspberry Pi running BIND9.</p>
</li>
<li>
<p><code>REV_SERVER_CIDR=192.168.1.0/24</code> (where 192.168.1.0/24 is an example)</p>
<p>The Pi-hole documentation says:</p>
<blockquote>
<p><em>"If conditional forwarding is enabled, set the reverse DNS zone (e.g. 192.168.0.0/24)".</em></p>
</blockquote>
<p>This is correct but it lacks detail.</p>
<p>The string "192.168.1.0/24" defines your local subnet using Classless Inter-Domain Routing (CIDR) notation. Most home subnets use a subnet-mask of 255.255.255.0. If you write that out in binary, it is 24 1-bits followed by 8 0-bits, as in:</p>
<div class="language-text highlight"><pre><span></span><code>   255  .   255  .   255  .   0
11111111 11111111 11111111 00000000
</code></pre></div>
<p>Those 24 one-bits are where the <code>/24</code> comes from in <code>192.168.1.0/24</code>. When you perform a bitwise logical AND between that subnet mask and 192.168.1.0, the ".0" is removed (conceptually), as in:</p>
<div class="language-text highlight"><pre><span></span><code>192.168.1.0 AND 255.255.255.0 = 192.168.1
</code></pre></div>
<p>What it <strong>means</strong> is:</p>
<ol>
<li>The network <em>prefix</em> is "192.168.1".</li>
<li><em>This</em> host on the 192.168.1 network is the reserved address "192.168.1.0". It is better to think of this as "the network prefix followed by all-zero bits in the host portion". It is not common to see the .0 address used in practice. A device either knows its IP address or it doesn't. If it doesn't then it won't know its prefix so it will use 0.0.0.0 as a substitute for "this".</li>
<li>The <em>range</em> of IP addresses available for allocation to hosts on this subnet is 192.168.1.1 through 192.168.1.254 inclusive.</li>
<li><em>All</em> hosts on the 192.168.1 network (ie broadcast) is the reserved address "192.168.1.255". It is better to think of this as "the network prefix followed by all-one bits in the host portion".</li>
</ol>
<p>When you set <code>REV_SERVER_CIDR=192.168.1.0/24</code> you are telling Pi-hole that <em>reverse queries</em> for the host range 192.168.1.1 through 192.168.1.254 should be sent to the <code>REV_SERVER_TARGET=192.168.1.5</code>.</p>
</li>
</ul>
</details>
<h2 id="webGUI">Pi-hole Web GUI<a class="headerlink" href="#webGUI" title="Permanent link">&para;</a></h2>
<p>Note: in order for Web GUI settings to have any effects, you need to configure
the RPi or other machines to use it. This is described in the next topics.</p>
<h3 id="connectGUI">Connecting to the GUI<a class="headerlink" href="#connectGUI" title="Permanent link">&para;</a></h3>
<p>Point your browser to:</p>
<div class="language-text highlight"><pre><span></span><code>http://«your_ip»:8089/admin
</code></pre></div>
<p>where «your_ip» can be:</p>
<ul>
<li>The IP address of the Raspberry Pi running Pi-hole.</li>
<li>The domain name of the Raspberry Pi running Pi-hole.</li>
<li>The multicast DNS name (eg "raspberrypi.local") of the Raspberry Pi running Pi-hole.</li>
</ul>
<h3 id="localNames">Adding local domain names<a class="headerlink" href="#localNames" title="Permanent link">&para;</a></h3>
<p>Login to the Pi-hole web interface: <code>http://raspberrypi.local:8089/admin</code>:</p>
<ol>
<li>Select from Left menu: Local DNS -&gt; DNS Records</li>
<li>Enter Domain: <code>raspberrypi.home.arpa</code> and the RPi's IP Address, e.g. <code>192.168.1.10</code>.</li>
<li>Press Add.</li>
</ol>
<p>Now you can use <code>raspberrypi.home.arpa</code> as the domain name for the Raspberry Pi
in your whole local network. You can also add domain names for your other
devices, provided they too have static IPs.</p>
<div class="admonition help">
<p class="admonition-title">why .home.arpa?</p>
<p id="homeArpa">Instead of <code>.home.arpa</code> - which is the real standard, but a mouthful - you
can use <code>.internal</code>. Using <code>.local</code> would technically work, but it should
be reserved for mDNS use only.</p>
</div>
<h2 id="rpiDNS">Configure the Raspberry Pi to use Pi-hole<a class="headerlink" href="#rpiDNS" title="Permanent link">&para;</a></h2>
<p>The Raspberry Pi itself does <strong>not</strong> have to use the Pi-hole container for its own DNS services. Some chicken-and-egg situations can exist if, for example, the Pi-hole container is down when another process (eg <code>apt</code> or <code>docker-compose</code>) needs to do something that depends on DNS services being available.</p>
<p>Nevertheless, if you configure Pi-hole to be local DNS resolver, then you will probably want to configure your Raspberry Pi to use the Pi-hole container in the first instance, and then fall back to a public DNS server if the container is down. As a beginner, this is probably what you want regardless. Do this by running the commands:</p>
<div class="language-console highlight"><pre><span></span><code><span class="gp">$ </span><span class="nb">echo</span> <span class="s2">&quot;name_servers=127.0.0.1&quot;</span> <span class="p">|</span> sudo tee -a /etc/resolvconf.conf
<span class="gp">$ </span><span class="nb">echo</span> <span class="s2">&quot;name_servers_append=8.8.8.8&quot;</span> <span class="p">|</span> sudo tee -a /etc/resolvconf.conf
<span class="gp">$ </span><span class="nb">echo</span> <span class="s2">&quot;resolv_conf_local_only=NO&quot;</span> <span class="p">|</span> sudo tee -a /etc/resolvconf.conf
<span class="gp">$ </span>sudo resolvconf -u
</code></pre></div>
<p>This results in a configuration that will continue working, even if the Pi-hole
container isn't running.</p>
<details class="info">
<summary>Detailed explanations of these commands</summary>
<ol>
<li>
<p><code>name_servers=127.0.0.1</code> instructs the Raspberry Pi to direct DNS queries to the loopback address. Port 53 is implied. If the Pi-hole container is running in:</p>
<ul>
<li>non-host mode, Docker is listening to port 53 and forwards the queries to the Pi-hole container;</li>
<li>host mode, the Pi-hole container is listening to port 53.</li>
</ul>
</li>
<li>
<p><code>name_servers_append=8.8.8.8</code> instructs the Raspberry Pi to fail-over to 8.8.8.8 if Pi-hole does not respond. You can replace <code>8.8.8.8</code> (a Google service) with:</p>
<ul>
<li>Another well-known public DNS server like <code>1.1.1.1</code> (Cloudflare).</li>
<li>The IP address(es) of your ISP's DNS hosts (generally available from your ISP's web site).</li>
<li>The IP address of another DNS server running in your local network (eg BIND9).</li>
<li>The IP address of your home router. Most home routers default to the ISP's DNS hosts but you can usually change your router's configuration to bypass your ISP in favour of public servers like 8.8.8.8 and 1.1.1.1.</li>
</ul>
<p>You need slightly different syntax if you want to add multiple fallback servers. For example, suppose your fallback hosts are a local server (eg 192.168.1.2) running BIND9 and 8.8.8.8. The command would be:</p>
<div class="language-console highlight"><pre><span></span><code><span class="gp">$ </span><span class="nb">echo</span> <span class="s1">&#39;name_servers_append=&quot;192.168.1.2 8.8.8.8&quot;&#39;</span> <span class="p">|</span> sudo tee -a /etc/resolvconf.conf
</code></pre></div>
</li>
<li>
<p><code>resolv_conf_local_only=NO</code> is needed so that 127.0.0.1 and 8.8.8.8 can coexist.</p>
</li>
<li>The <code>resolvconf -u</code> command instructs Raspberry Pi OS to rebuild the active resolver configuration. In principle, that means parsing <code>/etc/resolvconf.conf</code> to derive <code>/etc/resolv.conf</code>. This command can sometimes return the error "Too few arguments". You should ignore that error.</li>
</ol>
<pre class="mermaid"><code>flowchart LR
  RERECONF["/etc/resolvconf.conf"] --- UP([resolvconf -u])
  DHCP[DHCP provided DNS-server] --- UP
  UP -- "generates" --&gt; RECONF["/etc/resolv.conf"]
  classDef command fill:#9996,stroke-width:0px
  class UP command</code></pre>
</details>
<details class="note">
<summary>Advanced options: ignoring DHCP provided DNS-servers, local domain name search</summary>
<ul>
<li>
<p>If you wish to prevent the Raspberry Pi from including the address(es) of DNS servers learned from DHCP, you can instruct the DHCP client running on the Raspberry Pi to ignore the information coming from the DHCP server:</p>
<div class="language-console highlight"><pre><span></span><code><span class="gp">$ </span><span class="nb">echo</span> <span class="s1">&#39;nooption domain_name_servers&#39;</span> <span class="p">|</span> sudo tee -a /etc/dhcpcd.conf
<span class="gp">$ </span>sudo service dhcpcd reload
<span class="gp">$ </span>sudo resolvconf -u
</code></pre></div>
</li>
<li>
<p>If you have followed the steps in <a href="#localNames">Adding local domain names</a> to define names for your local hosts, you can inform the Raspberry Pi of that fact like this:</p>
<div class="language-console highlight"><pre><span></span><code><span class="gp">$ </span><span class="nb">echo</span> <span class="s1">&#39;search_domains=home.arpa&#39;</span> <span class="p">|</span> sudo tee -a /etc/resolvconf.conf
<span class="gp">$ </span>sudo resolvconf -u
</code></pre></div>
<p>That will add the following line to <code>/etc/resolv.conf</code>:</p>
<div class="language-text highlight"><pre><span></span><code>search home.arpa
</code></pre></div>
<p>Then, when you refer to a host by a short name (eg "fred") the Raspberry Pi will also consider "fred.home.arpa" when trying to discover the IP address.</p>
</li>
</ul>
</details>
<details class="note">
<summary>Interaction with other containers</summary>
<p>Docker provides a special IP 127.0.0.11, which listens to DNS queries and
resolves them according to the host RPi's resolv.conf. Containers usually
rely on this to perform DNS lookups. This is nice as it won't present any
surprises as DNS lookups on both the host and in the containers will yeild
the same results.</p>
<p>It's possible to make DNS queries directly cross-container, and even
supported in some <a href="../WireGuard/#customContInit">rare use-cases</a>.</p>
</details>
<h2 id="configure-pi-hole-as-your-local-dns-resolver">Configure Pi-hole as your local DNS resolver<a class="headerlink" href="#configure-pi-hole-as-your-local-dns-resolver" title="Permanent link">&para;</a></h2>
<p>To use the Pi-hole in your LAN, you need to assign the RPi a fixed IP-address and configure this IP as your DNS server.</p>
<h3 id="rpiFixedIP">1. Assign the RPi a fixed IP address<a class="headerlink" href="#rpiFixedIP" title="Permanent link">&para;</a></h3>
<p>If you want clients on your network to use Pi-hole for their DNS, the Raspberry Pi running Pi-hole <strong>must</strong> have a fixed IP address. It does not have to be a <em>static</em> IP address (in the sense of being hard-coded into the Raspberry Pi). The Raspberry Pi can still obtain its IP address from DHCP at boot time, providing your DHCP server (usually your home router) always returns the same IP address. This is usually referred to as a <em>static binding</em> and associates the Raspberry Pi's MAC address with a fixed IP address.</p>
<p>Keep in mind that many Raspberry Pis have both Ethernet and WiFi interfaces. It is generally prudent to establish static bindings for <em>both</em> network interfaces in your DHCP server.</p>
<p>You can use the following command to discover the MAC addresses for your Raspberry Pi's Ethernet and WiFi interfaces:</p>
<div class="language-console highlight"><pre><span></span><code><span class="gp">$ </span><span class="k">for</span> I <span class="k">in</span> eth0 wlan0 <span class="p">;</span> <span class="k">do</span> ip link show <span class="nv">$I</span> <span class="p">;</span> <span class="k">done</span>
<span class="go">2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP mode DEFAULT group default qlen 1000</span>
<span class="go">    link/ether dc:a6:32:4c:89:f9 brd ff:ff:ff:ff:ff:ff</span>
<span class="go">3: wlan0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP mode DEFAULT group default qlen 1000</span>
<span class="go">    link/ether e5:4f:01:41:88:b2 brd ff:ff:ff:ff:ff:ff</span>
</code></pre></div>
<p>In the above:</p>
<ul>
<li>The MAC address of the Ethernet interface is "dc:a6:32:4c:89:f9"</li>
<li>The MAC address of the WiFi interface is "e5:4f:01:41:88:b2"</li>
</ul>
<p>If a physical interface does not exist, the command returns "Device does not exist" for that interface. If you prefer, you can also substitute the <code>ifconfig</code> command for <code>ip link show</code>. It's just a little more wordy.</p>
<h3 id="rpiConfig">2. Configuring other machines to use the Raspberry Pi running Pi-hole<a class="headerlink" href="#rpiConfig" title="Permanent link">&para;</a></h3>
<p>In order for Pi-hole to block ads or resolve anything, clients need to be told to use it as their DNS server. You can either:</p>
<ol>
<li>Adopt a whole-of-network approach and edit the DNS settings in your DHCP server so that all clients are given the IP address of the Raspberry Pi running Pi-hole to use for DNS services when a lease is issued.</li>
<li>Adopt a case-by-case (manual) approach where you instruct particular clients to obtain DNS services from the IP address of the Raspberry Pi running Pi-hole.</li>
</ol>
<p>Option 1 (whole-of-network) is the simplest approach. Assuming your Raspberry Pi has the static IP <code>192.168.1.10</code>:</p>
<ol>
<li>
<p>Go to your network's DHCP server. In most home networks, this will be your Wireless Access Point/WLAN Router:</p>
<ul>
<li>Login into its web-interface</li>
<li>Find where DNS servers are defined (generally with DHCP controls)</li>
<li>Change all DNS fields to <code>192.168.1.10</code></li>
</ul>
</li>
<li>
<p>All local clients have to be rebooted. Without this they will continue to use the old DNS setting from an old DHCP lease for quite some time.</p>
</li>
</ol>
<p>Option 2 (case-by-case) generally involves finding the IP configuration options for each host and setting the DNS server manually. Manual changes are usually effective immediately without needing a reboot.</p>
<details class="note">
<summary>advanced configurations</summary>
<p id="advancedConfig">Setting up a combination of Pi-hole (for ad-blocking services), and/or a local upstream DNS resolver (eg BIND9) to be authoritative for a local domain and reverse-resolution for your local IP addresses, and decisions about where each DNS server forwards queries it can't answer (eg your ISP's DNS servers, or Google's 8.8.8.8, or Cloudflare's 1.1.1.1) is a complex topic and depends on your specific needs.</p>
<p>The same applies to setting up a DHCP server (eg DHCPD) which is capable of distinguishing between the various clients on your network (ie by MAC address) to make case-by-case decisions as to where each client should obtain its DNS services. </p>
<p>If you need help, try asking questions on the <a href="https://discord.gg/ZpKHnks">IOTstack Discord channel</a>.</p>
</details>
<h2 id="debugging">Testing and Troubleshooting<a class="headerlink" href="#debugging" title="Permanent link">&para;</a></h2>
<p>Make these assumptions:</p>
<ol>
<li>
<p>You have followed the instructions above to add these lines to <code>/etc/resolvconf.conf</code>:</p>
<div class="language-text highlight"><pre><span></span><code>name_servers=127.0.0.1
name_servers_append=8.8.8.8
resolv_conf_local_only=NO
</code></pre></div>
</li>
<li>
<p>The Raspberry Pi running Pi-hole has the IP address 192.168.1.10 which it obtains as a static assignment from your DHCP server.</p>
</li>
<li>You have configured your DHCP server to provide 192.168.1.10 for client devices to use to obtain DNS services (ie, you are saying clients should use Pi-hole for DNS).</li>
</ol>
<p>The result of the configuration appears in <code>/etc/resolv.conf</code>:</p>
<div class="language-console highlight"><pre><span></span><code><span class="gp">$ </span>cat /etc/resolv.conf
<span class="gp"># </span>Generated by resolvconf
<span class="go">nameserver 127.0.0.1</span>
<span class="go">nameserver 192.168.1.10</span>
<span class="go">nameserver 8.8.8.8</span>
</code></pre></div>
<p>Interpretation:</p>
<ul>
<li><code>nameserver 127.0.0.1</code> is present because of <code>name_servers=127.0.0.1</code></li>
<li><code>nameserver 192.168.1.10</code> is present because it was learned from DHCP</li>
<li><code>nameserver 8.8.8.8</code> is present because of <code>name_servers_append=8.8.8.8</code></li>
</ul>
<p>The fact that the Raspberry Pi is effectively represented twice (once as 127.0.0.1, and again as 192.168.1.10) does not matter. If the Pi-hole container stops running, the Raspberry Pi will bypass 192.168.1.10 and fail over to 8.8.8.8, failing back to 127.0.0.1 when the Pi-hole container starts again.</p>
<p>Install dig:</p>
<div class="language-console highlight"><pre><span></span><code><span class="gp">$ </span>sudo apt install dnsutils
</code></pre></div>
<p>Test that Pi-hole is correctly configured (should respond 192.168.1.10):</p>
<div class="language-console highlight"><pre><span></span><code><span class="gp">$ </span>dig raspberrypi.home.arpa @192.168.1.10
</code></pre></div>
<p>To test on another machine if your network's DNS configuration is correct, and
an ESP will resolve its DNS queries correctly, restart the other machine to
ensure DNS changes are updated and then use:</p>
<div class="language-console highlight"><pre><span></span><code><span class="gp">$ </span>dig raspberrypi.home.arpa
</code></pre></div>
<p>This should produce the same result as the previous command.</p>
<p>If this fails to resolve the IP, check that the server in the response is
<code>192.168.1.10</code>. If it's <code>127.0.0.xx</code> check <code>/etc/resolv.conf</code> begins with
<code>nameserver 192.168.1.10</code>. If not, check the machine is configured to use DHCP
and revisit <a href="#rpiConfig">Pi-hole as DNS</a>.</p>
<h2 id="iotConfig">Microcontrollers<a class="headerlink" href="#iotConfig" title="Permanent link">&para;</a></h2>
<p>If you want to avoid hardcoding your Raspberry Pi IP to your ESPhome devices,
you need a DNS server that will do the resolving. This can be done using the
Pi-hole container as described above.</p>
<h3 id="esp32mDNS"><code>*.local</code> won't work for ESPhome<a class="headerlink" href="#esp32mDNS" title="Permanent link">&para;</a></h3>
<p>There is a special case for resolving <code>*.local</code> addresses. If you do a <code>ping raspberrypi.local</code> on your desktop Linux or the Raspberry Pi, it will first try using mDNS/bonjour to resolve the IP address raspberrypi.local. If this fails it will then ask the DNS server. ESPhome devices can't use mDNS to resolve an IP address. You need a proper DNS server to respond to queries made by an ESP. As such, <code>dig raspberrypi.local</code> will fail, simulating ESPhome device behavior. This is as intended, and you should use raspberrypi.home.arpa as the address on your ESP-device.</p>
<h2 id="cleanSlate">Getting a clean slate<a class="headerlink" href="#cleanSlate" title="Permanent link">&para;</a></h2>
<p>If Pi-hole misbehaves, you can always try starting from a clean slate by erasing Pi-hole's persistent storage area. Erasing the persistent storage area causes PiHole to re-initialise its data structures on the next launch. You will lose:</p>
<ol>
<li>Any configuration options you may have set via the web GUI that are not otherwise reflected in <a href="#envVars">environment variables</a>.</li>
<li>Any whitelist, blacklist or local DNS records you entered.</li>
<li>All DNS resolution and blocking history.</li>
</ol>
<p>Also note that your <a href="#adminPassword">administrative password</a> will reset.</p>
<p>The recommended approach is:</p>
<ol>
<li>Login to Pi-hole's web GUI and navigate to Settings » Teleporter.</li>
<li>Click the <kbd>Backup</kbd> button to download a backup.</li>
<li>Logout of the Web GUI.</li>
<li>
<p>Run the following commands:</p>
<div class="language-console highlight"><pre><span></span><code><span class="gp">$ </span><span class="nb">cd</span> ~/IOTstack
<span class="gp">$ </span>docker-compose rm --force --stop -v pihole
<span class="gp">$ </span>sudo rm -rf ./volumes/pihole
<span class="gp">$ </span>docker-compose up -d pihole
</code></pre></div>
</li>
<li>
<p>Login to Pi-hole's web GUI and navigate to Settings » Teleporter.</p>
</li>
<li>Use the checkboxes to select the settings you wish to restore, and click the <kbd>Browse</kbd> and <kbd>Restore</kbd> buttons.</li>
</ol>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../OpenHab/" class="md-footer__link md-footer__link--prev" aria-label="Previous: openHAB" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              openHAB
            </div>
          </div>
        </a>
      
      
        
        <a href="../Plex/" class="md-footer__link md-footer__link--next" aria-label="Next: Plex" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Plex
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.annotate", "tabs", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections"], "search": "../../assets/javascripts/workers/search.2a1c317c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.ed9748b7.min.js"></script>
      
        <script src="../../javascript/fix-codeblock-console-copy-button.js"></script>
      
    
  </body>
</html>